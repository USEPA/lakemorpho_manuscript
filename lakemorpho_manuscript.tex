%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Original default rstudio/pandoc latex file
%% upated by @jhollist 09/15/2014
%% inspired by @cboetting https://github.com/cboettig/template and
%% @rmflight blog posts:
%% http://rmflight.github.io/posts/2014/07/analyses_as_packages.html 
%% http://rmflight.github.io/posts/2014/07/vignetteAnalysis.html).  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[11pt,]{article}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use microtype if available
\IfFileExists{microtype.sty}{\usepackage{microtype}}{}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\ImportTok}[1]{{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{{#1}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{{#1}}}}
\newcommand{\BuiltInTok}[1]{{#1}}
\newcommand{\ExtensionTok}[1]{{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\NormalTok}[1]{{#1}}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={},
            pdftitle={lakemorpho: Calculating lake morphometry metrics in R},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{0}

%jwh added to match pandoc tightlist function
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Changes borrowed from @cboettig, added by @jhollist 
% A modified page layout 
\textwidth 6.75in
\oddsidemargin -0.15in
\evensidemargin -0.15in
\textheight 9in
\topmargin -0.5in
\usepackage{lineno} % add 
  \linenumbers % turns line numbering on 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%Packages and layout changes by @jhollist 09/15/2014
\usepackage{ragged2e}
\usepackage[font=normalsize]{caption}
  \usepackage[doublespacing]{setspace}
\usepackage{parskip}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\rfoot{\today}
\lfoot{\thepage}
%%Changed default abstract width and added lines
\renewenvironment{abstract}{
  \hfill\begin{minipage}{1\textwidth}
  \rule{\textwidth}{1pt}\vspace{5pt}
  \normalsize
  \begin{justify}
  \bfseries\abstractname\vspace{5pt}
  \end{justify}}
  {\par\noindent\rule{\textwidth}{1pt}\end{minipage}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{lakemorpho: Calculating lake morphometry metrics in R}
\author{
Jeffrey W. Hollister
Joseph Stachelek
}
\date{}

\begin{document}
%%Edited by @jhollist 09/15/2014
%%Adds title from YAML
\begin{singlespace}
\begin{center}
\huge lakemorpho: Calculating lake morphometry metrics in R
\end{center}
%%Adds Author, correspond email asterisk, and affilnum from YAML
\begin{center}
\large
Jeffrey W. Hollister \textsuperscript{1} 
Joseph Stachelek \textsuperscript{2} 
\end{center}
%%Adds affiliations from YAML
\begin{justify}
\footnotesize \emph{ 
\\*
\textsuperscript{1}US Environmental Protection Agency, Office of Research and Development,
National Health and Environmental Effects Research Laboratory, Atlantic
Ecology Division, 27 Tarzwell Drive Narragansett, RI, 02882, USA\\*
\\*
\textsuperscript{2}Michigan State University, Department of Fisheries and Wildlife, Natural
Resources Building, 480 Wilson Road, Room 13, East Lansing, MI, 48824,
USA\\*
}
%%Adds corresponding author email(s) from YAML
\newcounter{num}
\setcounter{num}{1}
\\[0.1cm]
\footnotesize \emph{ 
}
\end{justify}
%%Adds date from YAML
\normalsize

\end{singlespace}


\singlespace

\vspace{2mm}

\hrule

Metrics describing the shape and size of lakes, known as lake
morphometry metrics, are important for any limnological study. In cases
where a lake has long been the subject of study these data are often
already collected and the data is openly available. Many other lakes
have this data collected, but access to the data is challenging as it is
often stored on individual computers (or worse in filing cabinets) and
is available only to the primary investigators. The vast majority of
lakes fall into a third category in which the data is not available.
This makes broad scale modelling of lake ecology a challenge as some of
the key information about in-lake processes are unavailable. While this
valuable \emph{in situ} information may be difficult to obtain, several
national datasets exist that may be used to model and estimate lake
morphometry. In particular, digital elevation models and hydrography
have been shown to be predicitive of several lake morphometry metrics.
The R package \texttt{lakemorpho} has been developed to utilize this
data and estimate the following morphometry metrics: surface area,
shoreline length, major/minor axis length, shoreline development,
maximum depth, mean depth, volume, maximum lake length, mean lake width,
maximum lake width, and fetch. In this software note we describe the
motivation behind developing \texttt{lakemorpho}, discuss the
implementation in R, and describe the use of \texttt{lakemorpho} with an
example of a typical use case.

\vspace{3mm}

\hrule

\doublespace

\section{Introduction}\label{introduction}

The study and quantificaiton of lake shape (i.e.~lake morphology and
morphometry) is one of the foundations of limnology and for students of
limnology, some of the first lessons are centered around a typical suite
of metrics and how to calculate them {[}1{]}. It is also widely accepted
that the morphometry of lakes and ponds can impact available nutrients
and thus overall productivity. For instance, the widely used
Vollenweider input-output models that are used to estimate nutrient
concentrations rely on hydraulic residence time and sometimes mean
depth, both of which are derived from total lake volume {[}2,3{]}. Also,
clear water versus turbid water states in lakes have been linked in part
to lake morphometry, in particular mean depth {[}4{]}. In short,
limnologists have long recognized the importance of lake morphology as
one factor controlling a variety of ecological processes in lakes.

Traditional methods for calculating lake morphometry metrics have relied
upon the use of paper bathymetry maps, planimeters, or simple heuristics
based on their values relative to other metrics that may not hold in all
settings {[}5--8{]}. In addition, detailed bathymetry is a requirement
for the calculation of most lake morphometry metrics, but is generally
only available for a relatively small number of lakes. Although this is
not a problem when the focus of a study is a single lake, a small number
of lakes, or a group of well-studied lakes, reliance on complete
bathymetry becomes a limitation when attempting to conduct regional or
national-scale lake studies. In these cases, alternative approaches for
estimating lake morphometry are required.

Recent work has demonstrated the ability to estimate many of these
metrics from ubiquitous spatial data. For instance, maximum depth and
lake volume may be predicted using the lake polygon and surrounding
topography {[}8--11{]} provided by the National Hydrography Dataset Plus
and the National Elevation Dataset, respectively {[}12,13{]}. The
initial development of these tools were developed with proprietary tools
thus limiting their use. In an effort to reach a broader audience the
tools were converted to R, expanded to include a more complete suite of
lake morphometry metrics and compiled into an R Package.

\section{Implementation and Use in R}\label{implementation-and-use-in-r}

Using R as a Geographic Information System is now possible as several
packages provide spatial data handling, geospatial analysis, and
visualization. It is becuase of these packages that \texttt{lakemorpho}
was implemented as an R package. In particular, \texttt{lakemorpho}
relies on the following packages: \texttt{maptools}, \texttt{rgdal},
\texttt{raster}, \texttt{rgeos}, \texttt{sp},
\texttt{geosphere}{[}14--20{]}. In addition to these packages two
external libraries, the Geospatial Data Abstraction Library (GDAL) and
Geometry Engine, Open Source (GEOS), are needed. Their availability to R
and installation varies by operating system {[}21,22{]}.

\subsection{\texorpdfstring{Using
\texttt{lakemorpho}}{Using lakemorpho}}\label{using-lakemorpho}

Included in \texttt{lakemorpho} are, one function to create a
\texttt{lakeMorpho} object, eleven functions to caclulate morphometry
metrics, a default plotting function, two example datasets, and an
example \texttt{lakeMorpho} object.

A typical workflow for using \texttt{lakemorpho} to calculate lake
metrics would include pulling spatial data into R (e.g.~as shapefiles,
tiff, etc.), creating a \texttt{lakeMorpho} object and calculating the
desired lake morphometry metrics. The following sections provide details
on the type of input data required and dicsuss the use of the functions,
including examples with the provided example data.

\subsubsection{\texorpdfstring{The \texttt{lakeMorpho} Class and
\texttt{lakeSurroundTopo}}{The lakeMorpho Class and lakeSurroundTopo}}\label{the-lakemorpho-class-and-lakesurroundtopo}

Many of the lake morphometry metrics rely on the same information about
the lake. For instance, the functions to estimate maximum depth, mean
depth, and volume rely on statistical summaries of the surrouding
topography as well as the maximum in-lake distance to shoreline.
{[}8,9{]}. To avoid recalculating these values, a \texttt{lakeMorpho}
class was created to store the information on surrounding topography as
well as the original datasets. This object is required input for all of
the lake morphometry functions in the the \texttt{lakemorpho} package.
In addition to this, an object of class \texttt{lakeMorpho} also holds
the initial datasets and, optionally, can store the spatial objects that
result from some of the lake morphometry functions. At a minimum, a
\texttt{lakeMorpho} object contains:

\begin{itemize}
\tightlist
\item
  ``lake'' - A \texttt{SpatialPolygons} or
  \texttt{SpatialPolygonsDataFrame} object of the original input lake
  data.
\item
  ``elev'' - A \texttt{RasterLayer} representing the elevation in a
  suitably large area around the lake.
\item
  ``surround'' - A \texttt{SpatialPolygons} or
  \texttt{SpatialPolygonsDataFrame} object representing the land area
  defined as the surrounding topography.
\item
  ``lakeDistance'' - A \texttt{RasterLayer} object of the euclidean
  distance from the shoreline to center of each pixel. Maximum value is
  equal to the maximum in-lake distance.
\item
  ``lakeOnEdge'' - A logical value indicating if the \texttt{lakeMorpho}
  value ``surround'' is on the edge of the value ``elev''.
\end{itemize}

The \texttt{lakeSurroundTopo} function is the primary mechanism for
creating a \texttt{lakeMorpho} object. There are two required inputs and
one optional input for \texttt{lakeSurroundTopo}. The first required
input is a \texttt{SpatialPolygons} or \texttt{SpatialPolygonsDataFrame}
of the lake {[}18{]}. Only a single lake is accepted as input, although
this lake may be composed of multiple polygons (i.e.~a lake with
islands). If metrics for multiple lakes are required they will need to
be passed to the suite of \texttt{lakemorpho} functions separately. The
second required input is a \texttt{RasterLayer} of the elevation
surrounding the lake {[}19{]}. The default raster size is taken from the
resolution of the input elevation data but may be specified separately.
The third input specifies the area representing the surrounding
topography. By default this is a buffer of the lake shoreline with the
buffer width equal to the maximum in-lake distance. An optional
\texttt{SpatialPolygons} object of any polygon intersecting the lake
(e.g.~catchements) can be used to define the surrounding topography
instead of the default buffer. An object of class \texttt{lakeMorpho} is
returned from \texttt{lakeSurroundTopo}

In addition to providing accepted inputs, users should pay attention to
both the extent of the input elevation dataset as well as the coordinate
reference systems used. First, the elevation data must be of a large
enough extent so that the surrounding topography does not inlcude land
area outside that extent (i.e would return NA values). As noted above,
the \texttt{lakeOnEdge} item indicates if the surrounding topography is
on the edge of the input elevation and thus returns NA values. Second,
all of the functions of \texttt{lakemorpho} assume that projections have
been handled prior to creating the \texttt{lakemorpho} class or
calculating the metrics. If the input data are not of the same
projection, \texttt{lakeSurroundTopo} will return an error. The data
must be reprojected into the same coordinate reference system (CRS).
Care must be taken in choosing a CRS as area and length measurments will
vary between different CRS.

Usage of \texttt{lakeSurroundTopo} and generating a \texttt{lakeMorpho}
object from the example data included with \texttt{lakemorpho} is done
as follows:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Load data}
\KeywordTok{data}\NormalTok{(lakes)}

\CommentTok{#Create lakeMorpho object, example_lakeMorpho, with required inputs}
\NormalTok{example_lakeMorpho <-}\StringTok{ }\KeywordTok{lakeSurroundTopo}\NormalTok{(exampleLake, exampleElev)}
\end{Highlighting}
\end{Shaded}

The resulting object contains the minimum set of values that are all of
the expected class.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lapply}\NormalTok{(example_lakeMorpho,class)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $lake
## [1] "SpatialPolygonsDataFrame"
## attr(,"package")
## [1] "sp"
## 
## $elev
## [1] "RasterLayer"
## attr(,"package")
## [1] "raster"
## 
## $surround
## [1] "SpatialPolygons"
## attr(,"package")
## [1] "sp"
## 
## $lakeDistance
## [1] "RasterLayer"
## attr(,"package")
## [1] "raster"
## 
## $lakeOnEdge
## [1] "logical"
\end{verbatim}

\subsubsection{Lake Morphometry
Functions}\label{lake-morphometry-functions}

Each of the remaining functions all expect a \texttt{lakeMorpho} object
as input and all return a numeric value. Some of the functions do have a
side effect of adding a spatial object to the input \texttt{lakeMorpho}
object.

\paragraph{calcLakeMetrics}\label{calclakemetrics}

The \texttt{calcLakeMetrics()} function is a convenience function that
will calculate all of the \texttt{lakemorpho} metrics for a single
\texttt{lakeMorpho} object. It requires an input \texttt{lakeMorpho} as
well as a \texttt{bearing} (for \texttt{lakeFetch}) and
\texttt{pointDens} for maximum lake length and width.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{calcLakeMetrics}\NormalTok{(example_lakeMorpho, }\DecValTok{0}\NormalTok{, }\DecValTok{250}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $surfaceArea
## [1] 16453180
## 
## $shorelineLength
## [1] 45991.38
## 
## $shorelineDevelopment
## [1] 3.198502
## 
## $maxDepth
## [1] 99.17621
## 
## $volume
## [1] 4802535
## 
## $meanDepth
## [1] 28.94864
## 
## $maxLength
## [1] 9176.819
## 
## $maxWidth
## [1] 3173.489
## 
## $meanWidth
## [1] 1792.907
## 
## $fetch
## [1] 6336.798
\end{verbatim}

\paragraph{lakeFetch}\label{lakefetch}

Fetch is the maximum open water distance in a given direction and can be
used an indicator of mixing as greater fetch implies greater potential
for waves{[}NEED REF{]}. The \texttt{lakeFetch()} function calculates
fetch along an input bearing. The input bearing may be any value from 0
to 360 where 0 and 360 both represent north, although the fetch for
opposite directions (e.g.~east and west) are identical.

To calulcate the fetch of an input lake use:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Fetch for North}
\KeywordTok{lakeFetch}\NormalTok{(example_lakeMorpho, }\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6336.798
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeFetch}\NormalTok{(example_lakeMorpho, }\DecValTok{360}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6336.798
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Fetch for West}
\KeywordTok{lakeFetch}\NormalTok{(example_lakeMorpho, }\DecValTok{270}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3129.997
\end{verbatim}

\paragraph{lakeMajorAxisLength}\label{lakemajoraxislength}

The major axis of a lake is defined as the longest line intersecting the
convex hull formed around its polygon while passing through its center.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeMajorAxisLength}\NormalTok{(example_lakeMorpho, }\DataTypeTok{addLine =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 13159.64
\end{verbatim}

\paragraph{lakeMaxDepth}\label{lakemaxdepth}

Maximum lake depth provides information that may be used to, along with
flow rates, estimate the residence time of a lake. While there is no
substitute for field verifed measurements, maximum lake depth may be
estimated with the surrounding topography. The \texttt{lakeMaxDepth()}
function uses the methods outlined in Hollister \emph{et al} {[}9{]} to
provide an estimate of the maximum lake depth. It requires only a
\texttt{lakeMorpho} object as input. Optionally a correction factor
based off of verified depth data may be specified is one is known.

The usage for \texttt{lakeMaxDepth()} is:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Maximum Lake Depth}
\KeywordTok{lakeMaxDepth}\NormalTok{(example_lakeMorpho)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 99.17621
\end{verbatim}

\paragraph{lakeMaxLength}\label{lakemaxlength}

Maximum lake length is the longest open water distance within a lake
and, similar to fetch, is a metric that can be used to estimate mixing
potential {[}23{]}. The current implementation of this in
\texttt{lakemorpho} places points at equal distances apart along the
shoreline of the lake and then finds the longest point-to-point distance
that also does not intersect land. This value is returned as the maximum
lake length. An optional parameter, with a default value of
\texttt{TRUE} allows the \texttt{SpatialLines} object to be stored on
the input \texttt{lakeMorpho} object.

To caluclate maximum lake length requires a \texttt{lakeMorpho} object
and total number of points to use to find the maximum point-to-point
distance.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Max Length with a Point Density of 250}
\KeywordTok{lakeMaxLength}\NormalTok{(example_lakeMorpho, }\DecValTok{250}\NormalTok{, }\DataTypeTok{addLine =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9409.7
\end{verbatim}

The \texttt{pointDens} parameter can have an impact on both the
processing time and the resulting value and both of these can vary as a
function of the complexity of the shape of the lake with less complex
lakes providing more consistent lake length across a range of number of
points (Figure \ref{fig:pointdens}). Given this caveat, care must be
taken in choosing an appropriate number of points (and thus lines) to
use to calculate maximum lake length. Several densities should be tested
and the smallest number of points that produce a stable estimate should
be used.

\paragraph{lakeMaxWidth}\label{lakemaxwidth}

Maximum lake width is the maximum shore to shore distance that is
perpendicular to the line representing maximum lake length and is
another metric related to mixing {[}23{]}. The \texttt{lakeMaxWidth}
function requires a \texttt{lakeMorpho} object and \texttt{pointDens}
value which is used to determine the number of points along the maximum
lake length line. The issue with \texttt{pointDens} that was discussed
above also exists for the use of \texttt{pointDens} with
\texttt{lakeMaxWidth()} and care should be taken to determine an
appropriate number of lines to test.

Usage of lakeMaxWidth is:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Max width with a point density of 250}
\KeywordTok{lakeMaxWidth}\NormalTok{(example_lakeMorpho, }\DecValTok{250}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3208.011
\end{verbatim}

\paragraph{lakeMeanDepth}\label{lakemeandepth}

Mean depth of a lake is calculated as the volume of the lake divided by
the area {[}23{]}. This function requires only a \texttt{lakeMorpho}
object and returns a numeric value of the mean depth. Usage of the
function is:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeMeanDepth}\NormalTok{(example_lakeMorpho)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 28.94864
\end{verbatim}

\paragraph{lakeMeanWidth}\label{lakemeanwidth}

The mean width of a lake is defined as lake area divided by maximum lake
length {[}23{]}. Input for this function is a \texttt{lakeMorpho} object
that has the maximum lake length line added. This requirement is checked
and returns an error if the maximim length line is missing.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Throws an error if maximum lake length is missing}
\KeywordTok{lakeMeanWidth}\NormalTok{(example_lakeMorpho)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1854.39
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Add Maximum Lake Length}
\KeywordTok{lakeMaxLength}\NormalTok{(example_lakeMorpho, }\DecValTok{100}\NormalTok{, }\DataTypeTok{addLine =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5824.158
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeMeanWidth}\NormalTok{(example_lakeMorpho)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2824.989
\end{verbatim}

\paragraph{lakeMinorAxisLength}\label{lakeminoraxislength}

The minor axis of a lake is defined as the shortest line intersecting
the convex hull formed around the lake polygon while passing through its
center.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeMinorAxisLength}\NormalTok{(example_lakeMorpho, }\DataTypeTok{addLine =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6926.263
\end{verbatim}

\paragraph{lakeMinorMajorRatio}\label{lakeminormajorratio}

The ratio of the lake major axis length to the minor axis length is also
known as the aspect ratio. Circular lakes have aspect ratios approaching
1 while thin-elongated lakes have aspect ratios approaching 0. If major
and minor axis length have not already been added to the
\texttt{lakeMoropho} object these are calculated. The \texttt{addLine}
argument adds the lines for the lake's minor and major axes to the
\texttt{lakeMorpho} object.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeMinorMajorRatio}\NormalTok{(example_lakeMorpho, }\DataTypeTok{addLine =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5263261
\end{verbatim}

\paragraph{lakeShorelineDevelopment}\label{lakeshorelinedevelopment}

The shoreline development metric provides a measure of the complexity of
the shoreline. It is a ratio the perimeter of the lake to the perimeter
of a circle of the same area. Values will be 1 or greater with value of
1 indicating a circular lake. This metric is used as an indicator of
potential habitat {[}23{]}. It only requires a \texttt{lakeMorpho}
object as input.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeShorelineDevelopment}\NormalTok{(example_lakeMorpho)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.198502
\end{verbatim}

\paragraph{lakeShorelineLength and
lakeSurfaceArea}\label{lakeshorelinelength-and-lakesurfacearea}

Shoreline length is simply the total perimeter of the lake polygon and
as with all other functions requires a \texttt{lakeMorpho} object as
input. To calculate the shoreline length:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeShorelineLength}\NormalTok{(example_lakeMorpho)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 45991.38
\end{verbatim}

Similarly, surface area for a lake is the total area of the lake
polygon. It is calculated via:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{lakeSurfaceArea}\NormalTok{(example_lakeMorpho)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 16453180
\end{verbatim}

\paragraph{lakeVolume}\label{lakevolume}

The \texttt{lakeVolume} function uses maximum lake depth (see
lakeMaxDepth) and methods outlined by Hollister \emph{et al.} {[}8{]} to
estimate lake volume. The method uses the ratio of the maximum depth to
the maximum distance\ldots{}

\section{Software Availability}\label{software-availability}

The \texttt{lakemorpho} version 1.1.0 package is currently available
directly from the Comprehensive R Archive Network (CRAN) and may simply
be installed and loaded in R via:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{install.packages}\NormalTok{(}\StringTok{'lakemorpho'}\NormalTok{)}
\KeywordTok{library}\NormalTok{(}\StringTok{'lakemorpho'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

To access the help pages (including a version of this manuscript) use.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{help}\NormalTok{(}\DataTypeTok{package=}\StringTok{'lakemorpho'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

There are tentative plans to continue developing new functions for
\texttt{lakemorpho} and these new features will be available first
through the development version on GitHub at
\href{http://github.com/USEPA/lakemorpho}{http://github.com/usepa/lakemorpho}.
To install and load the development version requires use of the
\texttt{devtools} package. This may be done with:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{install.packages}\NormalTok{(}\StringTok{'devtools'}\NormalTok{)}
\KeywordTok{library}\NormalTok{(}\StringTok{'devtools'}\NormalTok{)}
\KeywordTok{install_github}\NormalTok{(}\StringTok{'USEPA/lakemorpho'}\NormalTok{)}
\KeywordTok{library}\NormalTok{(lakemorpho)}
\end{Highlighting}
\end{Shaded}

\section{Figures}\label{figures}

\section*{References}\label{references}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\hypertarget{ref-wetzel2001limnology}{}
1. Wetzel R (2001) Limnology, 3 e. lake and river ecosystems. Academic
Press, California. 850 p.

\hypertarget{ref-vollenweider1975input}{}
2. Vollenweider RA (1975) Input-output models. Schweizerische
Zeitschrift fÃ¼r Hydrologie 37: 53--84.

\hypertarget{ref-milstead2013estimating}{}
3. Milstead WB, Hollister JW, Moore RB, Walker HA (2013) Estimating
summer nutrient concentrations in northeastern lakes from sparrow load
predictions and modeled lake depth and volume. PloS one 8: e81457.

\hypertarget{ref-genkai2005eutrophication}{}
4. Genkai-Kato M, Carpenter SR (2005) Eutrophication due to phosphorus
recycling in relation to lake morphometry, temperature, and macrophytes.
Ecology 86: 210--219.

\hypertarget{ref-kalff2002limnology}{}
5. Kalff J (2002) Limnology: Inland water ecosystems. Prentice Hall New
Jersey. 592 p.

\hypertarget{ref-welch1935limnology}{}
6. Welch P (1935) Limnology. McGraw-Hill, New York.

\hypertarget{ref-wetzel2000limnological}{}
7. Wetzel RG, Likens G (2000) Limnological analyses 3rd editon. Springer
Verlag, New York.

\hypertarget{ref-hollister2010volume}{}
8. Hollister J, Milstead WB (2010) Using GIS to estimate lake volume
from limited data. Lake and Reservoir Management 26: 194--199.

\hypertarget{ref-hollister2011predicting}{}
9. Hollister JW, Milstead WB, Urrutia MA (2011) Predicting maximum lake
depth from surrounding topography. PLoS ONE 6: e25764. Available:
\url{http://dx.doi.org/10.1371/journal.pone.0025764}. Accessed 28 Jun
2013.

\hypertarget{ref-messager2016estimating}{}
10. Messager ML, Lehner B, Grill G, Nedeva I, Schmitt O (2016)
Estimating the volume and age of water stored in global lakes using a
geo-statistical approach. Nature Communications 7.

\hypertarget{ref-oliver2016prediction}{}
11. Oliver SK, Soranno PA, Fergus CE, Wagner T, Winslow LA, et al.
(2016) Prediction of lake depth across a 17-state region in the united
states. Inland Waters 6: 314--324.

\hypertarget{ref-usepa2005national}{}
12. USEPA U (2005) National hydrography dataset plus--NHDPlus.

\hypertarget{ref-gesch2009national}{}
13. Gesch D, Evans G, Mauck J, Hutchinson J, Carswell Jr W (2009) The
national map-elevation: US geological survey fact sheet 2009-3053, 4 p.

\hypertarget{ref-bivand2014maptools}{}
14. Bivand R, Lewin-Koh N (2014) Maptools: Tools for reading and
handling spatial objects. Available:
\url{http://CRAN.R-project.org/package=maptools}.

\hypertarget{ref-bivand2014rgdal}{}
15. Bivand R, Keitt T, Rowlingson B (2014) Rgdal: Bindings for the
geospatial data abstraction library. Available:
\url{http://CRAN.R-project.org/package=rgdal}.

\hypertarget{ref-bivand2014rgeos}{}
16. Bivand R, Rundel C (2014) Rgeos: Interface to geometry engine - open
source (geos). Available: \url{http://CRAN.R-project.org/package=rgeos}.

\hypertarget{ref-bivand2008applied}{}
17. Bivand RS, Pebesma EJ, GÃ³mez-Rubio V (2008) Applied spatial data
analysis with r. Springer.

\hypertarget{ref-pebesma2005sp}{}
18. Pebesma EJ, Bivand RS (2005) Classes and methods for spatial data in
r. R news 5: 9--13.

\hypertarget{ref-hijmans2014raster}{}
19. Hijmans RJ (2014) Raster: Raster: Geographic data analysis and
modeling. Available: \url{http://CRAN.R-project.org/package=raster}.

\hypertarget{ref-hijmans2014geosphere}{}
20. Hijmans RJ (2014) Geosphere: Spherical trigonometry. Available:
\url{http://CRAN.R-project.org/package=geosphere}.

\hypertarget{ref-GDAL2012}{}
21. GDAL Development Team (2012) GDAL - geospatial data abstraction
library, version 1.9.2. Open Source Geospatial Foundation. Available:
\href{\%20http://www.gdal.org}{http://www.gdal.org}.

\hypertarget{ref-GEOS2013}{}
22. Foundation OSG (2013) GEOS - geometry engine - open source. Open
Source Geospatial Foundation. Available:
\url{http://trac.osgeo.org/geos/}.

\hypertarget{ref-lakewatch2001department}{}
23. LAKEWATCH F (2001) Department of fisheries and aquatic sciences, a
beginner's guide to water management-lake morphometry.

\end{document}